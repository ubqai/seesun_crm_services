{% extends 'mobile_base.html' %}
{% from 'macros/mobile_partial.html' import header %}
{% block content %}
{{ header('产品列表') }}

<div class="main-content">

	<div class="wrapper">
		<div class="table-responsive">
			<table class="table table-striped">
				<thead>
					<tr>
						<th>产品目录</th>
						<th>产品</th>
						<th>Sku</th>
						<th>库存</th>
                        <th>已下单数量</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody>
				{% for category in categories %}
                    {% with products_json = load_products(category.get('category_id')) %}
                        {% if len(products_json) > 0 %}
                            {% for product_json in products_json %}
                                {% with skus_json = load_skus(product_json.get('product_id')) %}
                                    {% if len(skus_json.get('skus')) > 0 %}
                                        {% for sku in skus_json.get('skus') %}
                                            <tr>
                                                <td>{{ category.get('category_name') }}</td>
                                                <td>{{ product_json.get('name') }}</td>
                                                <td>
                                                    {% for option in sku.get('options') %}
                                                        {% for key, value in option.items() %}
                                                            {{ value }}
                                                        {% endfor %}
                                                    {% endfor %}
                                                </td>
                                                <td>{{ sku.get('stocks') }}</td>
                                                <td >{{ sku.get('stocks_for_order') }}</td>
                                                <td>
                                                    <a href="{{ url_for('new_share_inventory', id = sku.get('sku_id')) }}" class="table-del text-success"><span class="glyphicon glyphicon-plus"></span>&nbsp;&nbsp;共享库存</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    {% endif %}
                                {% endwith %}
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
				{% endfor %}
                </tbody>
            </table>
		</div>
	</div>
</div>

{% endblock %}